---
layout: post
title: "Oracle中的时间和时区"
description: "Datetime and TimeZone in oracle"
category: Datebase
tags: [Datebase, Oracle]
---
{% include JB/setup %}

#Oralce中的常用时间类型#
* Date
* Timestamp
* Timestamp with Timezone
* Timestamp with local Timezone

#Oracle中常用的时间函数#
* sysdate/systimestamp
* current_date/current_timestamp
* TO_TIMESTAMP
* TO_TIMESTAMP_TZ
* TO_DATE 

#oracle中相关的时区#
*  数据库所在的操作系统的时区
*  数据库时区(DB Timezone)
*  会话时区(Session Timezone)

To be continue...
修改数据库时区：
ALTER DATABASE SET TIME_ZONE = '+08:00'
修改会话时区：
ALTER SESSION SET TIME_ZONE='+08:00';

Daylight Saving Time

alter database set time_zone 和数据库中有一些列的数据类型是：TIMESTAMP WITH LOCAL TIME ZONE 冲突

查看哪些字段试用了Timezone with local TZ:
select u.name || '.' || o.name || '.' || c.name TSLTZcolumn
  from sys.obj$ o, sys.col$ c, sys.user$ u
 where c.type# = 231
   and o.obj# = c.obj#
   and u.user# = o.owner#;

English material presentation:

1. sysdate/systimestamp: the current date and time set for the operating system on which the database resides
current_date/current_timestamp: the current date in the session time zone

2. create table TIMESTAMP_TEST
(
  ID          NUMBER,
  TIME        DATE,
  TIMESTP     TIMESTAMP(3),
  TIMESTP_TZ  TIMESTAMP(3) WITH TIME ZONE,
  TIMESTP_LTZ TIMESTAMP(3) WITH LOCAL TIME ZONE
)

insert into timestamp_test values (SEQ_TIMESTAMP_TEST.NEXTVAL, sysdate, sysdate, sysdate, sysdate);
insert into timestamp_test values (SEQ_TIMESTAMP_TEST.NEXTVAL, current_date, current_date, current_date, current_date );

6/11/2013 6:33:45 PM	11-JUN-13 06.33.45.000 PM	11-JUN-13 06.33.45.000 PM +08:00	11-JUN-13 06.33.45.000 PM
6/11/2013 6:33:46 PM	11-JUN-13 06.33.46.000 PM	11-JUN-13 06.33.46.000 PM +08:00	11-JUN-13 06.33.46.000 PM

select sessiontimezone from dual;

SESSIONTIMEZONE
---------------------------------------------------------------------------
+08:00

alter session set time_zone = '-05:00';

Try insert again:
insert into timestamp_test values (SEQ_TIMESTAMP_TEST.NEXTVAL, sysdate, sysdate, sysdate, sysdate);
insert into timestamp_test values (SEQ_TIMESTAMP_TEST.NEXTVAL, current_date, current_date, current_date, current_date );

6/11/2013 6:41:34 PM	11-JUN-13 06.41.34.000 PM	11-JUN-13 06.41.34.000 PM -05:00	12-JUN-13 07.41.34.000 AM
6/11/2013 5:41:35 AM	11-JUN-13 05.41.35.000 AM	11-JUN-13 05.41.35.000 AM -05:00	11-JUN-13 06.41.35.000 PM

取出来的local TimeZone也会跟着SessionTimeZone 转换

Reference Link:
http://docs.oracle.com/cd/B19306_01/server.102/b14225/ch4datetime.htm
